
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Opacity &#8212; Sedona6  documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hydrodynamics" href="hydrodynamics.html" />
    <link rel="prev" title="Radiation Sources" href="sources.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="hydrodynamics.html" title="Hydrodynamics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sources.html" title="Radiation Sources"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Sedona6  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="opacity">
<h1>Opacity<a class="headerlink" href="#opacity" title="Permalink to this headline">¶</a></h1>
<p>There are several options for calculating and controlling the opacity
of the gas in the calculation.</p>
<p>Though we generally use the word “opacity”, the code actually calculates and stores an extinction coefficient.
The two are related by</p>
<div class="math">
<p><img src="_images/math/38af2b9d7186cd3ad7a16035f278b942769cd903.png" alt="\alpha = \kappa \rho"/></p>
</div><p>where
<img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> is the extinction coefficient (units <img class="math" src="_images/math/d8b0a1aec2535760109fe6fbe0ad8ab38227ef92.png" alt="{\rm cm}^{-1}"/>),
<img class="math" src="_images/math/e18d839a0e889a07a4e7a17bed70fe453966c6df.png" alt="\kappa"/> is the opacity (units <img class="math" src="_images/math/9c97c6af89692182bce7c73595179b4dc7f04dbc.png" alt="{\rm cm}^{2}"/> <img class="math" src="_images/math/4ba16e0072742b4fc54fb487552bd3f6db0e0e59.png" alt="{\rm g}^{-1}"/>),
and <img class="math" src="_images/math/9a51ab9a0b521705e1e8762fac6bdd6f11771758.png" alt="\rho"/> is the mass density</p>
<div class="section" id="grey-opacity">
<h2>Grey Opacity<a class="headerlink" href="#grey-opacity" title="Permalink to this headline">¶</a></h2>
<p>The grey opacity flags allow the user to specify a simple,
wavelength-independent opacity. <em>Note that setting grey opacity
will override all other forms of opacity described below</em>.</p>
<p>To set a uniform grey opacity at all points in space, set the parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opacity_grey_opacity</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
<p>where, in this example, the code will set the
value <img class="math" src="_images/math/6f4a9a1823a977a59ada59e47bbd88dbc48b5761.png" alt="\kappa_{g} = 0.1"/> <img class="math" src="_images/math/9c97c6af89692182bce7c73595179b4dc7f04dbc.png" alt="{\rm cm}^{2}"/> <img class="math" src="_images/math/4ba16e0072742b4fc54fb487552bd3f6db0e0e59.png" alt="{\rm g}^{-1}"/>
to all zones in the model. All other sources of opacity discussed below
(e.g., free-free, bound-free) will be ignored.</p>
<p>The user can also set a spatially varying grey opacity, provided that a dataset
named grey_opacity giving the value of kappa in every zone has been set in an
input hdf5 model file. Then setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opacity_zone_specific_grey_opacity</span>    <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>will use the kappa defined in the model file</p>
</div>
<div class="section" id="continuum-opacities">
<h2>Continuum opacities<a class="headerlink" href="#continuum-opacities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="electron-scattering-opacity">
<h3>Electron Scattering Opacity<a class="headerlink" href="#electron-scattering-opacity" title="Permalink to this headline">¶</a></h3>
<p>To turn on electron-scattering opacity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opacity_electron_scattering</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This is calculated as</p>
<div class="math">
<p><img src="_images/math/e6b1222777d239e58a45306ee4ac2c059bf519c2.png" alt="\alpha_{\rm es} = \sigma_t n_e"/></p>
</div><p>where <img class="math" src="_images/math/493e3b4c79402433c6895e3e0e60a80fe45846a3.png" alt="n_e"/> is the free electron density</p>
<p>Options for include Klein-Nishina corrections, Comptonization etc…</p>
</div>
<div class="section" id="bound-free-opacity">
<h3>Bound-Free Opacity<a class="headerlink" href="#bound-free-opacity" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="free-free-opacity">
<h3>Free-Free Opacity<a class="headerlink" href="#free-free-opacity" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="line-opacity">
<h2>Line Opacity<a class="headerlink" href="#line-opacity" title="Permalink to this headline">¶</a></h2>
<p>There are various options for treating lines. In general, only one of these approaches
should be used to treat lines, unless one can be certain that line opacity is not be
multiply counted.</p>
<div class="section" id="resolved-bound-bound-opacity">
<h3>Resolved Bound-Bound Opacity<a class="headerlink" href="#resolved-bound-bound-opacity" title="Permalink to this headline">¶</a></h3>
<p>This approach is selecting by setting the runtime parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opacity_bound_bound</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This approach treats the lines generally as Voigt profiles. The frequency good must be
fine enough that there are multiple grid points across to resolve the line profile.</p>
<p>The widths of lines can be artificially broadened using the runtime parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">line_velocity_width</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">real</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where &lt;real&gt; is a velocity (in cm/s) by which the lines should be Gaussian broadened.</p>
</div>
<div class="section" id="line-expansion-opacity">
<h3>Line Expansion Opacity<a class="headerlink" href="#line-expansion-opacity" title="Permalink to this headline">¶</a></h3>
<p>This approach is selected by setting the runtime parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opacity_line_expansion</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This approach bins lines into frequency bins, assuming a homologous flow.</p>
<p>This approach implies the Sobolev approximation. For each line, the code calculates the Sobolev optical depth</p>
<div class="math">
<p><img src="_images/math/73bb07773ac26a3329457476776db5ccce8093de.png" alt="\tau_{\rm sob} = \frac{ \pi e^2}{m_e c} n_l f_{lu} \lambda_0 t_{\rm exp}"/></p>
</div><p>where…</p>
<p>The expansion opacity is then calculated by binning lines</p>
<div class="math">
<p><img src="_images/math/3a01ffb6198b9682630021fee471021a86d983f7.png" alt="\alpha_{\rm exp} = \frac{1}{c t_{\rm exp}} \frac{\lambda_0}{\Delta \lambda} \sum_i (1 - e^{-\tau_i})"/></p>
</div><p>Some linelists (such as the Kurucz lists) are in a format that do not include
as much detail about the atomic levels. These can be included as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opacity_fuzz_expansion</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The physics here is identical to that of line expansion opacity, it is
just that the lines are read from an independent file.</p>
</div>
<div class="section" id="resonant-line-scattering">
<h3>Resonant Line Scattering<a class="headerlink" href="#resonant-line-scattering" title="Permalink to this headline">¶</a></h3>
<p>This is how we would treat scattering in strong individual lines like Lyman alpha.</p>
</div>
</div>
<div class="section" id="user-defined-opacity">
<h2>User Defined Opacity<a class="headerlink" href="#user-defined-opacity" title="Permalink to this headline">¶</a></h2>
<p>You can write your own function</p>
</div>
<div class="section" id="lte-and-nlte-settings">
<h2>LTE and NLTE settings<a class="headerlink" href="#lte-and-nlte-settings" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="opacity-parameters">
<h2>Opacity Parameters<a class="headerlink" href="#opacity-parameters" title="Permalink to this headline">¶</a></h2>
<table border="1" class="colwidths-given docutils" id="id1">
<caption><span class="caption-text">Opacity parameters</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="29%" />
<col width="14%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">parameter</th>
<th class="head">values</th>
<th class="head">definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>opacity_grey_opacity</td>
<td>&lt;real&gt;</td>
<td>value of grey opacity to use (in cm^2/g). Will override all other opacity settings</td>
</tr>
<tr class="row-odd"><td>opacity_zone_specific_grey_opacity</td>
<td>0 = no | 1 = yes</td>
<td>Use a zone-specific grey opacity dataset that is set in an hdf5 input model file and named grey_opacity</td>
</tr>
<tr class="row-even"><td>opacity_user_defined</td>
<td>0 = no | 1 = yes</td>
<td>Calculate opacities by calling the function</td>
</tr>
<tr class="row-odd"><td>opacity_epsilon</td>
<td>&lt;float&gt;</td>
<td>The fraction of</td>
</tr>
<tr class="row-even"><td>opacity_atom_zero_epsilon</td>
<td>&lt;int&gt;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>opacity_electron_scattering</td>
<td>0 = no | 1 = yes</td>
<td>include electron scattering opacity</td>
</tr>
<tr class="row-even"><td>opacity_line_expansion</td>
<td>0 = no | 1 = yes</td>
<td>include binned line expansion opacity</td>
</tr>
<tr class="row-odd"><td>opacity_fuzz_expansion</td>
<td>0 = no | 1 = yes</td>
<td>include binned line expansion opacity, taken from a fuzz file</td>
</tr>
<tr class="row-even"><td>opacity_bound_free</td>
<td>0 = no | 1 = yes</td>
<td>include bound-free (photoionization) opacity</td>
</tr>
<tr class="row-odd"><td>opacity_free_free</td>
<td>0 = no | 1 = yes</td>
<td>include free-free opacity</td>
</tr>
<tr class="row-even"><td>opacity_bound_bound</td>
<td>0 = no | 1 = yes</td>
<td>include bound-bound (resolved line) opacity</td>
</tr>
<tr class="row-odd"><td>opacity_use_nlte</td>
<td>0 = no | 1 = yes</td>
<td>include nlte opacity</td>
</tr>
<tr class="row-even"><td>opacity_atoms_in_nlte</td>
<td>&lt;int vector&gt;</td>
<td>A vector of atomic numbers of the species to be treated in NLTE</td>
</tr>
<tr class="row-odd"><td>opacity_use_collisions_nlte</td>
<td>0 = no | 1 = yes</td>
<td>only matters if use_nlte == 1, include collisions for nlte calculations</td>
</tr>
<tr class="row-even"><td>opacity_no_ground_recomb</td>
<td>0 = no | 1 = yes</td>
<td>Suppress all recombination transitions to the ground state in the NLTE level population solve</td>
</tr>
<tr class="row-odd"><td>opacity_minimum_extinction</td>
<td>&lt;float&gt;</td>
<td>Minimum value of the extinction coefficient (units 1/cm) in any zone</td>
</tr>
<tr class="row-even"><td>opacity_maximum_opacity</td>
<td>&lt;float&gt;</td>
<td>Minimum value of the extinction coefficient (units 1/cm) in any zone</td>
</tr>
<tr class="row-odd"><td>opacity_no_scattering</td>
<td>0 = no | 1 = yes</td>
<td>if = 1, will not include any kind of scattering opacity</td>
</tr>
<tr class="row-even"><td>dont_decay_composition</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>opacity_compton_scatter_photons</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>line_velocity_width</td>
<td>&lt;float&gt;</td>
<td>velocity in cm/s used to doppler broaden the (bound bound?) lines</td>
</tr>
<tr class="row-odd"><td>line_x_extent</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Opacity</a><ul>
<li><a class="reference internal" href="#grey-opacity">Grey Opacity</a></li>
<li><a class="reference internal" href="#continuum-opacities">Continuum opacities</a><ul>
<li><a class="reference internal" href="#electron-scattering-opacity">Electron Scattering Opacity</a></li>
<li><a class="reference internal" href="#bound-free-opacity">Bound-Free Opacity</a></li>
<li><a class="reference internal" href="#free-free-opacity">Free-Free Opacity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#line-opacity">Line Opacity</a><ul>
<li><a class="reference internal" href="#resolved-bound-bound-opacity">Resolved Bound-Bound Opacity</a></li>
<li><a class="reference internal" href="#line-expansion-opacity">Line Expansion Opacity</a></li>
<li><a class="reference internal" href="#resonant-line-scattering">Resonant Line Scattering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-defined-opacity">User Defined Opacity</a></li>
<li><a class="reference internal" href="#lte-and-nlte-settings">LTE and NLTE settings</a></li>
<li><a class="reference internal" href="#opacity-parameters">Opacity Parameters</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="sources.html"
                        title="previous chapter">Radiation Sources</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hydrodynamics.html"
                        title="next chapter">Hydrodynamics</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/opacity.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="hydrodynamics.html" title="Hydrodynamics"
             >next</a> |</li>
        <li class="right" >
          <a href="sources.html" title="Radiation Sources"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Sedona6  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, D. Kasen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>